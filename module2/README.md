# Demo2025 - Модуль 2

**[Задание](https://github.com/damh66/demo2025/blob/main/%D0%9A%D0%9E%D0%94%2009.02.06-1-2025%20%D0%A2%D0%BE%D0%BC%201%20(%D1%81%D0%BE%D0%BA%D1%80).pdf)**

<br/>

## Топология:

<p align="center">
  <img width="450" height="600" src="https://github.com/user-attachments/assets/8ee209f5-6fed-4f03-bbe3-e202155957b3"
<p\>

<br/>

## Задание 1

**Настройте доменный контроллер Samba на машине BR-SRV**

- Создайте 5 пользователей для офиса HQ: имена пользователей фомата user№.hq. Создайте группу hq, введите в эту группу созданных пользователей

- Введите в домен машину HQ-CLI

- Пользователи группы hq имеют право аутентифицироваться на клиентском ПК

- Пользователи группы hq должны иметь возможность повышать привилегии для выполнения ограниченного набора команд: cat, grep, id. Запускать другие команды с повышенными привилегиями пользователи не имеют права

- Выполните импорт пользователей из файла users.csv. Файл будет располагаться н авиртуальной машине BR-SRV в папке /opt

<br/>

<details>
<summary>Не решено</summary>
<br/>

</details>

<br/>

## Задание 2

**Сконфигурируйте файловое хранилище**

- При помощи трех дополнительных дисков, размером 1Гб каждый, на HQ-SRV сконфигурируйте дисковый массив уровня 5

- Имя устройства - md0, конфигурация массива размещается в файле /etc/mdadm.conf

- Обеспечьте автоматическое монтирование в папку /raid5

- Создайте раздел, отформатируйте раздел, в качестве файловой системы используйте ext4

- Настройте сервер сетевой файловой системы (nfs), в качестве папки общего доступа выберите /raid5/nfs, доступ для чтения и записи для всей сети в сторону HQ-CLI

- На HQ-CLI настройте автомонтирование в папку /mnt/nfs

- Основные параметры сервера отметьте в отчете

<br/>

<details>
<summary>Решение</summary>
<br/>

**Создание RAID**

Просматриваем имена добавленных дисков командой **`lsblk`** и получаем вывод:
```
sdb  8:16  0  1G  0  disk
sdc  8:32  0  1G  0  disk
sdd  8:48  0  1G  0  disk
```

<br/>

Обнуляем суперблоки для добавленных дисков:
```
mdadm --zero-superblock --force /dev/sd{b,c,d}
```
> Вывод `mdadm: Unrecongised md component device - /dev/sdx` гласит о том, что диски не использовались ранее для **RAID**

<br/>

Удаляем старые метаданные и подпись на дисках:
```
wipefs --all --force /dev/sd{b,c,d}
```

<br/>

Создаем **RAID**:
```
mdadm --create /dev/md0 -l 5 -n 3 /dev/sd{b,c,d}
```
> **/dev/md0** - название RAID после сборки
>
> **-l 5** - уровень RAID
>
> **-n 3** - количество дисков, из которых собирается массив
>
> **/dev/sd{b,c,d}** - диски, из которых выполняется сборка

<br/>

Проверяем командой **`lsblk`**:
```
sdb  8:16  0  1G  0  disk
  md0  9:0  0  2G  0  raid5
sdc  8:32  0  1G  0  disk
  md0  9:0  0  2G  0  raid5
sdd  8:48  0  1G  0  disk
  md0  9:0  0  2G  0  raid5
```

<br/>

**Создание файла `mdadm.conf`**

Создаем директорию для файла:
```
mkdir /etc/mdadm
```

<br/>

Заполняем файл информацией:
```
echo "DEVICE partitions" > /etc/mdadm/mdadm.conf
mdadm --detail --scan | awk '/ARRAY/ {print}' >> /etc/mdadm/mdadm.conf
```

<br/>

**Создание файловой системы и монтирование RAID-массива**

Создаем директорию для монтирования массива:
```
mkdir /etc/raid5
```

<br/>

Добавляем строку в **`/etc/fstab`**:
```
/dev/md0  /etc/raid5  ext4  defaults  0  0
```

<br/>

Монтируем:
```
mount -a
```

<br/>

Проверяем командой **`df -h`** и получаем вывод:
```
/dev/md0  2.0G  24K  1.9G  1%  /etc/raid5
```



<br/>




</details>

<br/>
